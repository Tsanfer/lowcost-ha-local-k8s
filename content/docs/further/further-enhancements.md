---
draft: false
title: '进一步的工作'
weight: 3
---

{{< callout emoji="🛠" >}}
  此页内容待完善
{{< /callout >}}

## 新增功能特性

其与现有系统的主要差别在于：

### 硬件计划

- 全高可用

  升级超融合集群配置，使其拥有实时故障转移的能力，实现全高可用
- 万兆光纤网络

  升级网络为万兆光纤网络，让超融合集群节点间的故障转移时间缩短为原来的十分之一
- 断电保护

  增加在线式不间断电源（UPS），可以避免因突然断电而导致的系统故障。它为系统中的各个软硬件提供了充足的断电应急处理缓冲时间，确保能够及时保存工作状态和重要数据。
- IPMI 远程管理

  One-KVM

### 软件计划

- CI/CD

  - 代码仓库
  - Jenkins
  - Harbor
- 代理转发

  - 双机热备
  - 负载均衡
- 增强安全性

  - 防火墙
  - WAF
  - 堡垒机
- 增强运维监控

  - Ansible
  - Prometheus

### 其他计划

- 增强自主可控

  摆脱对供应商、商业许可、在线连接、外部仓库及特定技术专家的依赖，实现更高程度的自主可控与软硬件自由。为了进一步增强自主可控能力，后续拟采取措施：

  1. 增加软件的离线部署方式。
  2. 把所有硬件测试软件全部替换为可永久免费使用的软件，并优先采用开源软件。
  3. 把所有非硬件测试软件全部替换为开源软件，并优先选用社区口碑高、维护活跃的软件。

## 系统架构图

## 集群成本

|组件|名称|参考价格|备注|
| -------| -------------| ----------| -------------------------------|
|CPU|E5-2695V4|CN¥135.00|18核36线程，TDP120W|
|内存||CN¥300.00|64G，DDR4，2133MHz|
|硬盘|幻隐HV2063|CN¥310.00|64G SATA.＋1T，NVMe，PCIe 3.0x4|
|主板|脑科 X99D4M4|CN¥174.00|x99，内存四通道，八相供电|
|电源|航嘉 MVP K600|CN¥118.00|额定600W，80PLUS金牌|
|机箱||CN¥25.00|matx 机箱|
|CPU散热||CN¥65.00|双塔，六铜管，三风扇|
|显卡||CN¥20.00||
|网卡||CN¥120.00|万兆光口 + 光模块|

|组件|名称|参考价格|备注|
| ---------------| ------------------| ------------| ---------------------------------------------|
|PVE 节点 1||CN¥1,267.00|18核36线程，64G内存，1T NVMe 固态硬盘，组装机|
|PVE 节点 2||CN¥1,267.00|18核36线程，64G内存，1T NVMe 固态硬盘，组装机|
|PVE 节点 3||CN¥1,267.00|18核36线程，64G内存，1T NVMe 固态硬盘，组装机|
|数据库 主节点|升腾 D610 瘦客户端|CN¥250.00|2核4线程，8G内存，256G固态硬盘|
|数据库 从节点 1|升腾 D610 瘦客户端|CN¥250.00|2核4线程，8G内存，256G固态硬盘|
|数据库 从节点 2|升腾 D610 瘦客户端|CN¥250.00|2核4线程，8G内存，256G固态硬盘|
|瘦客户端电源||CN¥50.00|12V10A，1分8电源线|
|八口全光交换机||CN¥400.00||
|光电交换机||CN¥100.00|2光万兆4电2.5G交换机|
|路由器|小米千兆路由器 R3G|CN¥40.00||
|光纤||CN¥15.00|单模光纤|
|以太网网线||CN¥25.00|6类千兆网线|
|不间断电源|山特 TG-BOX850|CN¥320.00||

|组件|名称|参考价格|备注|
| ------| -------------| ------------| --------------------------------------------------------|
|域名|.com 类型域名|CN¥100.00|网站备案及服务入口|
|云主机|阿里云云主机|CN¥300.00|2c2g，带宽按量，虚拟专用网认证及中转服务器|
|电费||CN¥2,200.00|维持设备运行，整个系统预估三分之一负载时功耗为 400W 左右|

‍

**设备成本（参考）：5501 元**

年维护成本（参考）：2600 元

- 全高可用万兆光网集群，**预估首年投入为：8101元**

‍

‍

## 节点规划

- 安全层节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| ------------| -------------| ------------| ------------| --------------| ------| ----------|
|[WAF](https://www.wolai.com/7KHiFYTsh2G7Fs8ajpYdw6 "WAF")|waf|2|4|32|192.168.0.11||虚拟机|
|[堡垒机](https://www.wolai.com/jwC1CvqNSnDnCKahScZWT9 "堡垒机")|jumpserver|4|8|64|192.168.0.12||虚拟机|

- 集群代理网关节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| -----------| -------------| ------------| ------------| --------------| ------| ----------|
|[集群代理网关](https://www.wolai.com/g8WoxGwGfRoxtWyJpZakLE "集群代理网关")|traefik-1|2|4|32|192.168.0.21||虚拟机|
|[集群代理网关](https://www.wolai.com/dgyRpQZ6BLxodT7ZPpjFTW "集群代理网关")|traefik-2|2|4|32|192.168.0.22||虚拟机|

- Kubernetes集群节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| ---------------| -------------| ------------| ------------| --------------| ------| ----------|
|[控制节点](https://www.wolai.com/9Q74rPuYCo2acrtARRqjF5 "控制节点")|k8s-control-1|2|8|64|192.168.0.31||虚拟机|
|[控制节点](https://www.wolai.com/j6qBApv4ny5a7x8kaLBnJQ "控制节点")|k8s-control-2|2|8|64|192.168.0.32||虚拟机|
|[控制节点](https://www.wolai.com/uPa9NAFJMhA9N5a2LTkSmC "控制节点")|k8s-control-3|2|8|64|192.168.0.33||虚拟机|
|[工作节点](https://www.wolai.com/tShGy6uLerqXTpjYVrYHgu "工作节点")|k8s-worker-1|4|16|64|192.168.0.34||虚拟机|
|[工作节点](https://www.wolai.com/cGbeVwYnMGfWMLucH2HCuw "工作节点")|k8s-worker-2|4|16|64|192.168.0.35||虚拟机|
|[工作节点](https://www.wolai.com/f6iZ7BDfNNpk53H6CfUmWz "工作节点")|k8s-worker-3|4|16|64|192.168.0.36||虚拟机|

- 存储节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| --------| -------------| ------------| ------------| --------------| ------| ----------|
|[存储节点](https://www.wolai.com/a7K3HqzMF1E5nPfyQJgNxZ "存储节点")|ceph-1|4|8|256|192.168.0.41||物理机|
|[存储节点](https://www.wolai.com/dfPoNTK1JGsTTVBqXSNTKC "存储节点")|ceph-2|4|8|256|192.168.0.42||物理机|
|[存储节点](https://www.wolai.com/oFnAXE1SpQ6NDkZuBuu6Ga "存储节点")|ceph-3|4|8|256|192.168.0.43||物理机|

数据库节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| -----------------| -------------| ------------| ------------| --------------| ------| ----------|
|[主数据库](https://www.wolai.com/x1LXbyFwc11hnb47Grvs63 "主数据库")|pgsql-primary|4|8|128|192.168.0.51||物理机|
|[从数据库](https://www.wolai.com/nzjdYrUyAF9QRU9XCmp7JU "从数据库")|pgsql-replica-1|4|8|128|192.168.0.52||物理机|
|[从数据库](https://www.wolai.com/3psefY9aeNvgtSrGJGGMwj "从数据库")|pgsql-replica-2|2|8|128|192.168.0.53||物理机|

- 运维节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| ---------| -------------| ------------| ------------| --------------| ------| ----------|
|[运维管理](https://www.wolai.com/hffLn9nUJZAQyr5D3JYezX "运维管理")|monitor|4|8|64|192.168.0.61||虚拟机|

- CI/CD 节点规划

|节点角色|主机名|CPU（线程）|内存（GB）|硬盘（GB）|IP|备注|部署环境|
| ----------| --------| -------------| ------------| ------------| --------------| ------| ----------|
|[CI](https://www.wolai.com/kR8hys1yf13CUkuN6t6mSg "CI")/CD|cicd|4|8|128|192.168.0.71||虚拟机|

- 总部署资源需求

|资源类型|需求CPU（线程）|需求内存（GB）|需求硬盘（GB）|备注|
| ----------| -----------------| ----------------| ----------------| ------|
|[Kubernetes集群](https://www.wolai.com/eum1mp2i7u1Eho9h4rTGqU "Kubernetes集群")|18|72|384||
|[数据库](https://www.wolai.com/46odQ3RdTUUnBKBiG38Wop "数据库")|12|24|512||
|[运维管理](https://www.wolai.com/8scYmSRXcfK7PmVvmWEwbE "运维管理")|4|8|64||
|[CI/CD](https://www.wolai.com/sZeFwCWCLMqgc1CDZLqQYe "CI/CD")|4|8|128||
|[安全层](https://www.wolai.com/45ZZEEJw2kQPdKJxPSuH4S "安全层")|6|12|96||
|[集群代理网关](https://www.wolai.com/4CjNrrzgyMeZVCyUBw9oAC "集群代理网关")|4|8|64||
|[存储节点](https://www.wolai.com/mUhohaPXvmZenisvP2fFMY "存储节点")|10|24|768||

‍

‍

‍

‍
